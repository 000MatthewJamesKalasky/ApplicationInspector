[
  {
    "name": "Feature: Authentication (MicrosoftOnline)",
    "id": "AI034900",
    "description": "Feature: Authentication (MicrosoftOnline) using Microsoft Identity Platform (ADAL/MSAL) or similar",
    "tags": [
      "Feature.Authentication.MicrosoftOnline"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "login\\.microsoftonline\\.com|SASToken|login\\.live.com|outlook\\.com|SAS Token|Shared Access Signature|AAD",
        "type": "regex",
        "scopes": [ "code", "comment" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "adal|msal|System.IdentityModel.Tokens.Jwt|AzureADB2C|SingleAccountPublicClientApplication|MultipleAccountPublicClientApplication",
        "type": "regex",
        "scopes": [ "code", "comment" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Feature: Authentication (Google)",
    "id": "AI034910",
    "description": "Feature: Authentication (Google)",
    "tags": [
      "Feature.Authentication.Google"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "using Google\\.Apis\\.Auth|GoogleCredential|AppIdentityCredential|oauth2/google|apis\\.google\\.com/js/api\\.js",
        "type": "regex",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "OIDAuthorizationRequest|accounts.google.com/o/oauth2|googleapis.com/oauth2|GTMAppAuth",
        "type": "regex",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Feature: Authentication (Oauth)",
    "id": "AI035000",
    "description": "Feature: Authentication (Oauth)",
    "tags": [
      "Feature.Authentication.Oauth"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "oauth",
        "type": "regex",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "auth_*token|access_*token|client_credentials|client_*id|client_*secret|openid",
        "type": "regex-word",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "Authorization: Bearer",
        "type": "string",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "bearer",
        "type": "string",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "medium",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Feature: Authentication (OpenIDConnect)",
    "id": "AI035001",
    "description": "Feature: Authentication (OpenIDConnect)",
    "tags": [
      "Feature.Authentication.OpenIDConnect"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "OpenID",
        "type": "regex",
        "scopes": [ "code", "comment" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Feature: Authentication (Active Directory)",
    "id": "AI035100",
    "description": "Feature: Authentication",
    "tags": [
      "Feature.Authentication.Windows.AD"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "active-directory|Active *Directory|ADFS|PrincipleContext|ValidateCredentials",
        "type": "regex-word",
        "scopes": [ "code", "comment" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "Microsoft\\.IdentityModel",
        "type": "regex",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "System.DirectoryServices",
        "type": "string",
        "scopes": [ "code", "comment" ],
        "modifiers": [ "i" ],
        "confidence": "medium",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Feature: Authentication (LDAP)",
    "id": "AI035200",
    "description": "Feature: Authentication (LDAP)",
    "tags": [
      "Feature.Authentication.LDAP"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "LDAP|ldaps",
        "type": "regex-word",
        "scopes": [ "code", "comment" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "LDAP",
        "type": "sub-string",
        "scopes": [ "code", "comment" ],
        "modifiers": [ "i" ],
        "confidence": "medium",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Feature: Authentication (NTML)",
    "id": "AI035300",
    "description": "Feature: Authentication (NTML)",
    "tags": [
      "Feature.Authentication.Windows.NTLM"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "WWW-Authenticate: NTLM|windowsAuthentication|CredentialCache\\.DefaultCredentials|HTTPNtlmAuthHandler",
        "type": "regex",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "LogonUserA|LogonUserEx|LogonUserW",
        "type": "regex",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "NTLM",
        "type": "string",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "medium",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Feature: Authentication (JWT)",
    "id": "AI035400",
    "description": "Feature: Authentication (JWT)",
    "tags": [
      "Feature.Authentication.JWT"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "jwt|RFC 7519|System.IdentityModel.Tokens.Jwt",
        "type": "regex-word",
        "scopes": [
          "code",
          "comment"
        ],
        "modifications": [ "i" ],
        "confidence": "high",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Feature: Authentication (HTML Form)",
    "id": "AI035410",
    "description": "Feature: Authentication (HTML Form)",
    "tags": [
      "Feature.Authentication.HTMLForm"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": " type=['\\\"]password['\\\"] ",
        "type": "regex",
        "scopes": [
          "code"
        ],
        "modifications": [ "i" ],
        "confidence": "high",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Feature: Authentication (SAML)",
    "id": "AI035420",
    "description": "Feature: Authentication (SAML)",
    "tags": [
      "Feature.Authentication.SAML"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "SAML|saml2",
        "type": "regex",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Feature: Authentication (General)",
    "id": "AI035430",
    "description": "Feature: Authentication (General)",
    "tags": [
      "Feature.Authentication.General"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "identity|auth|authenticated|authentication|log(in|on)|log(off|out)|signin|sign-?in|signout|sign-?out",
        "type": "regex-word",
        "scopes": [
          "code"
        ],
        "modifications": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "(username|userid|password|passphrase|multi-factor|credential|acct)s?",
        "type": "regex-word",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "Authorization: Basic|WWW-Authenticate",
        "type": "regex",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "connection_*string|conn_*string",
        "type": "regex",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "medium",
        "_comment": ""
      },
      {
        "pattern": "federation|sso|networkcredential",
        "type": "regex-word",
        "scopes": [ "code" ],
        "modifiers": [ "i" ],
        "confidence": "medium",
        "_comment": ""
      }
    ]
  }
]