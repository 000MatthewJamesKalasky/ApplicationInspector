[
  {
    "name": "Cryptography: x.509 Use",
    "id": "AI001300",
    "description": "Cryptography: x.509 Certificate Use",
    "tags": [
      "Cryptography.x509.Use"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "x509|\\.(crt|cer|spc|p7b|p7s|p7r|ca-bundle)|certificate",
        "type": "regex-word",
        "scopes": [
          "code"
        ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": "do not include pfx or pem see rule below for x509 client auth"
      },
      {
        "pattern": "PKCS|PaddingMode|SubjectIdentifier",
        "type": "regex",
        "scopes": [ "code" ],
        "confidence": "high",
        "modifiers": [ "i" ],
        "_comment": ""
      }
    ]
  },
  {
    "name": "Cryptography: x.509 Use",
    "id": "AI001400",
    "description": "Cryptography: x.509 Certificate Use",
    "applies_to": ["c", "cpp", "csharp"],
    "tags": [
      "Cryptography.x509.Use"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "_CERT|CERT_",
        "type": "regex",
        "scopes": [
          "code"
        ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Cryptography: x.509 ClientAuth",
    "id": "AI001500",
    "description": "Cryptography: x.509 Certificate ClientAuth",
    "tags": [
      "Cryptography.x509.ClientAuth"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "\\.(pem|pfx|key)",
        "type": "regex-word",
        "scopes": [
          "code"
        ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Cryptography: x.509 Create",
    "id": "AI001600",
    "description": "Cryptography: x.509 Create Certificate",
    "tags": [
      "Cryptography.x509.Create"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "genrsa|-keyout|-x509toreq|csr",
        "type": "regex-word",
        "scopes": [
          "code"
        ],
        "modifiers": [],
        "confidence": "high",
        "_comment": "Common OpenSSL commands"
      },
      {
        "pattern": "---BEGIN CERTIFICATE---",
        "type": "regex-word",
        "scopes": [
          "code"
        ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      },
      {
        "pattern": "---BEGIN PKCS",
        "type": "regex",
        "scopes": [
          "code"
        ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": "allow for PKCS7, other"
      },
      {
        "pattern": "(create|generate) (cert|certificate)",
        "type": "regex",
        "scopes": [
          "comment"
        ],
        "modifiers": [],
        "confidence": "high",
        "_comment": "Common OpenSSL commands or comments"
      }
    ]
  },
  {
    "name": "Cryptography: DigitalSignature",
    "id": "AI001700",
    "description": "Cryptography: DigitalSignature",
    "applies_to": [
      "csharp"
    ],
    "tags": [
      "Cryptography.DigitalSignature"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "DSA",
        "type": "regex-word",
        "scopes": [ "code" ],
        "confidence": "high",
        "modifiers": [ "" ],
        "_comment": ""
      },
      {
        "pattern": "DSACng",
        "type": "regex",
        "scopes": [ "code" ],
        "confidence": "high",
        "modifiers": [ "" ],
        "_comment": ""
      },
      {
        "pattern": "DSACryptoServiceProvider",
        "type": "regex-word",
        "scopes": [ "code" ],
        "confidence": "high",
        "modifiers": [ "" ],
        "_comment": ""
      },
      {
        "pattern": "DSASignatureDeformatter",
        "type": "regex-word",
        "scopes": [ "code" ],
        "confidence": "high",
        "modifiers": [ "" ],
        "_comment": ""
      },
      {
        "pattern": "DSASignatureFormatter",
        "type": "regex-word",
        "scopes": [ "code" ],
        "confidence": "high",
        "modifiers": [ "" ],
        "_comment": ""
      },
      {
        "pattern": "DSAKeyValue",
        "type": "regex",
        "scopes": [ "code" ],
        "confidence": "high",
        "modifiers": [ "" ],
        "_comment": ""
      },
      {
        "pattern": "DSAParameters",
        "type": "regex",
        "scopes": [ "code" ],
        "confidence": "high",
        "modifiers": [ "" ],
        "_comment": ""
      }
    ]
  },
  {
    "name": "Cryptography: DigitalSignature",
    "id": "AI001800",
    "description": "Cryptography: DigitalSignature",
    "tags": [
      "Cryptography.DigitalSignature"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "sign|signature|signer|signed",
        "type": "regex-word",
        "scopes": [
          "code"
        ],
        "modifiers": [ "i" ],
        "confidence": "medium",
        "_comment": ""
      }
    ]
  },
  {
    "name": "Cryptography: CodeSign",
    "id": "AI001900",
    "description": "Cryptography: CodeSign",
    "tags": [
      "Cryptography.CodeSign"
    ],
    "severity": "moderate",
    "patterns": [
      {
        "pattern": "sign(ing)* *key|code *sign|authenticode",
        "type": "regex",
        "scopes": [
          "code"
        ],
        "modifiers": [ "i" ],
        "confidence": "high",
        "_comment": ""
      }
    ]
  }
]
